<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ðŸŽ† Happy New Year ðŸŽ†</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #000;
  overflow: hidden;
  touch-action: manipulation;
}

canvas {
  display: block;
}

#title {
  position: fixed;
  top: 38%;
  width: 100%;
  text-align: center;
  font-size: clamp(28px, 6vw, 52px);
  font-family: Arial, sans-serif;
  font-weight: bold;
  transition: color 0.3s, text-shadow 0.3s;
  z-index: 10;
  user-select: none;
}

#subtitle {
  position: fixed;
  top: 48%;
  width: 100%;
  text-align: center;
  font-size: clamp(14px, 3.5vw, 18px);
  color: #ccc;
  font-family: Arial, sans-serif;
  opacity: 0.8;
  z-index: 10;
  user-select: none;
}
</style>
</head>
<body>

<div id="title">ðŸŽ† HAPPY NEW YEAR ðŸŽ†</div>
<div id="subtitle">Báº¥m vÃ o mÃ n hÃ¬nh hoáº·c click vÃ o Ä‘á»ƒ cÃ³ Ã¢m thanh</div>
<canvas id="canvas"></canvas>

<!-- ðŸ”Š SOUND -->
<audio id="launchSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_9b8b8b4c94.mp3" preload="auto"></audio>
<audio id="boomSound" src="https://cdn.pixabay.com/audio/2022/03/10/audio_8c9c7d6d4d.mp3" preload="auto"></audio>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const title = document.getElementById("title");

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const launchSound = document.getElementById("launchSound");
const boomSound = document.getElementById("boomSound");

const COLORS = [
  "#ff4040", "#ffd700", "#00e5ff",
  "#00ff7f", "#ff00ff", "#ff8c00"
];

// ===== ROCKET =====
class Rocket {
  constructor(x = Math.random() * canvas.width) {
    this.x = x;
    this.y = canvas.height;
    this.speed = Math.random() * 2 + 6;
    this.exploded = false;
    this.trail = [];
  }

  update() {
    // lÆ°u trail
    this.trail.push({ x: this.x, y: this.y });
    if (this.trail.length > 10) this.trail.shift();

    this.y -= this.speed;
    this.speed *= 0.995; // bay mÆ°á»£t hÆ¡n

    if (this.y <= canvas.height * (0.3 + Math.random() * 0.2) && !this.exploded) {
      this.exploded = true;
      explode(this.x, this.y);
      boomSound.cloneNode().play();
    }
  }

  draw() {
    // trail
    for (let i = 0; i < this.trail.length; i++) {
      const p = this.trail[i];
      ctx.globalAlpha = i / this.trail.length;
      ctx.fillStyle = "orange";
      ctx.fillRect(p.x, p.y, 2, 6);
    }
    ctx.globalAlpha = 1;

    // Ä‘áº§u phÃ¡o
    ctx.fillStyle = "#fff";
    ctx.fillRect(this.x, this.y, 2, 8);
  }
}

// ===== PARTICLE =====
class Particle {
  constructor(x, y, color) {
    this.x = x;
    this.y = y;
    this.color = color;
    this.life = 110;
    const angle = Math.random() * Math.PI * 2;
    const speed = Math.random() * 6 + 2;
    this.vx = Math.cos(angle) * speed;
    this.vy = Math.sin(angle) * speed;
  }

  update() {
    this.x += this.vx;
    this.y += this.vy;
    this.vy += 0.05;
    this.life--;
  }

  draw() {
    ctx.globalAlpha = this.life / 110;
    ctx.beginPath();
    ctx.arc(this.x, this.y, 2.2, 0, Math.PI * 2);
    ctx.fillStyle = this.color;
    ctx.fill();
    ctx.globalAlpha = 1;
  }
}

let rockets = [];
let particles = [];

// ===== EFFECT =====
function explode(x, y) {
  const color = COLORS[Math.floor(Math.random() * COLORS.length)];

  // Ä‘á»•i mÃ u chá»¯ theo phÃ¡o
  title.style.color = color;
  title.style.textShadow = `0 0 30px ${color}`;

  const count = innerWidth < 600 ? 50 : 90;
  for (let i = 0; i < count; i++) {
    particles.push(new Particle(x, y, color));
  }
}

function launchRocket(x) {
  rockets.push(new Rocket(x));
  launchSound.cloneNode().play();
}

// ===== LOOP =====
function animate() {
  ctx.fillStyle = "rgba(0,0,0,0.25)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  rockets = rockets.filter(r => {
    r.update();
    r.draw();
    return !r.exploded;
  });

  particles = particles.filter(p => {
    p.update();
    p.draw();
    return p.life > 0;
  });

  requestAnimationFrame(animate);
}
animate();

// ===== AUTO FIRE =====
setInterval(() => launchRocket(), 1000);

// ===== CLICK / TOUCH =====
addEventListener("pointerdown", e => {
  launchRocket(e.clientX);
});
</script>

</body>
</html>
