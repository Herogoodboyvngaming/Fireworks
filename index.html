<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ðŸŽ† Happy New Year ðŸŽ†</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #000;
  overflow: hidden;
  touch-action: manipulation;
}

canvas {
  display: block;
}

#title {
  position: fixed;
  top: 40%;
  width: 100%;
  text-align: center;
  font-size: clamp(28px, 6vw, 52px);
  font-family: Arial, sans-serif;
  font-weight: bold;
  transition: color 0.3s, text-shadow 0.3s;
  z-index: 10;
  user-select: none;
}
</style>
</head>
<body>

<div id="title">ðŸŽ† HAPPY NEW YEAR ðŸŽ†</div>
<canvas id="canvas"></canvas>

<!-- ðŸ”Š SOUND -->
<audio id="launchSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_9b8b8b4c94.mp3" preload="auto"></audio>
<audio id="boomSound" src="https://cdn.pixabay.com/audio/2022/03/10/audio_8c9c7d6d4d.mp3" preload="auto"></audio>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const title = document.getElementById("title");

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const launchSound = document.getElementById("launchSound");
const boomSound = document.getElementById("boomSound");

const COLORS = [
  "#ff4040", "#ffd700", "#00e5ff",
  "#00ff7f", "#ff00ff", "#ff8c00"
];

// ===== ROCKET =====
class Rocket {
  constructor(x = Math.random() * canvas.width) {
    this.x = x;
    this.y = canvas.height;
    this.speed = Math.random() * 3 + 6;
    this.exploded = false;
  }

  update() {
    this.y -= this.speed;
    if (this.y <= canvas.height * 0.4 && !this.exploded) {
      this.exploded = true;
      explode(this.x, this.y);
      boomSound.cloneNode().play();
    }
  }

  draw() {
    ctx.fillStyle = "#fff";
    ctx.fillRect(this.x, this.y, 2, 8);
  }
}

// ===== PARTICLE =====
class Particle {
  constructor(x, y, color) {
    this.x = x;
    this.y = y;
    this.color = color;
    this.life = 90;
    const angle = Math.random() * Math.PI * 2;
    const speed = Math.random() * 5 + 2;
    this.vx = Math.cos(angle) * speed;
    this.vy = Math.sin(angle) * speed;
  }

  update() {
    this.x += this.vx;
    this.y += this.vy;
    this.vy += 0.04; // gravity nháº¹
    this.life--;
  }

  draw() {
    ctx.globalAlpha = this.life / 90;
    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
    ctx.fill();
    ctx.globalAlpha = 1;
  }
}

let rockets = [];
let particles = [];

// ===== EFFECT =====
function explode(x, y) {
  const color = COLORS[Math.floor(Math.random() * COLORS.length)];

  // Ä‘á»•i mÃ u chá»¯ theo phÃ¡o
  title.style.color = color;
  title.style.textShadow = `0 0 25px ${color}`;

  const count = innerWidth < 600 ? 40 : 70; // tá»‘i Æ°u mobile
  for (let i = 0; i < count; i++) {
    particles.push(new Particle(x, y, color));
  }
}

function launchRocket(x) {
  rockets.push(new Rocket(x));
  launchSound.cloneNode().play();
}

// ===== LOOP =====
function animate() {
  ctx.fillStyle = "rgba(0,0,0,0.25)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  rockets = rockets.filter(r => {
    r.update();
    r.draw();
    return !r.exploded;
  });

  particles = particles.filter(p => {
    p.update();
    p.draw();
    return p.life > 0;
  });

  requestAnimationFrame(animate);
}
animate();

// ===== AUTO FIRE =====
setInterval(() => launchRocket(), 900);

// ===== CLICK / TOUCH =====
addEventListener("pointerdown", e => {
  launchRocket(e.clientX);
});
</script>

</body>
</html>
